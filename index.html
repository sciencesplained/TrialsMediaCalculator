<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Clinical Trial Recruitment Cost Calculator</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
  <div style="max-width:800px; padding:10px;">
    <h3>Clinical Trial Recruitment Cost Calculator</h3>

    <p style="background:#eef;padding:10px;border-radius:6px;margin-bottom:20px;">
      This tool estimates the true cost of recruiting participants into clinical trials — including staff, site setup, dropouts, and incentives. It helps planners assess the <strong>Return on Investment (ROI)</strong> of media investments such as explainer videos and digital outreach.
      <br><br>
      Results are based on your inputs, with assumptions informed by:
      <ul style="margin-left:20px;">
        <li><strong>Screen failure rates:</strong> 30–50% — see Walters et al., 2017 (NIHR HTA)</li>
        <li><strong>Dropout rates:</strong> 10–20% — see Murphy et al., 2022 (Trials journal)</li>
        <li><strong>Site setup costs:</strong> £3,000–£7,000 — based on NIHR interactive costing tool</li>
        <li><strong>Staff costs:</strong> ~£5,000/month — NHS Band 6–7 averages</li>
        <li><strong>Overhead multiplier:</strong> 25% — standard for indirects (e.g., facilities, utilities)</li>
        <li><strong>Cost of delays:</strong> Recruitment delays are very common — over 50% of UK trials recruit slower than expected (see Myers et al., 2019; NIHR reports)</li>
      </ul>
      You can customise any value to match your trial plan. Adjustments for screen failures and dropouts ensure per-participant costs reflect actual resource use. 
    </p>

    <label>🎯 Target Participants: <input type="number" id="targetParticipants" value="100" /></label><br>
    <label>🕐 Recruitment Duration (months): <input type="number" id="recruitmentMonths" value="10" /></label><br>
    <label>💸 Staff Cost per Month (£): <input type="number" id="staffCostPerMonth" value="5000" /></label><br>
    <label>👥 Staff Time (FTE): <input type="number" step="0.1" id="fte" value="1.0" /></label><br>
    <label>🧪 Screen Failure Rate (%): <input type="number" id="screenFailure" value="40" /></label><br>
    <label>🧍‍♂️ Drop-out Rate (%): <input type="number" id="dropoutRate" value="15" /></label><br>
    <label>💷 Incentive per Participant (£): <input type="number" id="incentivePerParticipant" value="50" /></label><br>
    <label>🏥 Number of Sites: <input type="number" id="siteCount" value="1" /></label><br>
    <label>🧾 Site Setup Cost per Site (£): <input type="number" id="siteSetupCost" value="5000" /></label><br>
    <label>🏢 Include Facilities/Overhead (25%)? <input type="checkbox" id="includeOverhead" checked /></label><br><br>

    <button onclick="calculateMain()">Calculate Recruitment Costs</button><br><br>
    <div id="mainResult"></div>
    <div id="costBreakdown" style="margin-top:20px;"></div>

    <div id="roiSection" style="display:none;margin-top:40px;">
      <h3>Explore Media Investment Impact</h3>
      <label>🎬 One-off Media Investment (£):
        <select id="investment">
          <option value="2000">£2,000</option>
          <option value="3000" selected>£3,000</option>
          <option value="4000">£4,000</option>
        </select>
      </label><br>
      <label>📈 Media Impact (% Faster Recruitment):
        <select id="impact">
          <option value="0.05">Minimal (5%)</option>
          <option value="0.10">Conservative (10%)</option>
          <option value="0.15" selected>Moderate (15%)</option>
          <option value="0.25">Optimistic (25%)</option>
        </select>
      </label><br><br>

      <button onclick="calculateROI()">Calculate ROI & Show Graph</button><br><br>
      <div id="roiResult"></div>
      <canvas id="timelineChart" width="700" height="400" style="margin-top:20px;"></canvas>
      <div id="scenarioTable" style="margin-top:20px;"></div>
    </div>

    <h2>📥 Download Your Report</h2>
    <button onclick="downloadPDF()">Download PDF</button>
  </div>

  <script src="script.js"></script>
</body>
</html>
